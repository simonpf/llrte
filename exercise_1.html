
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Exercise 1 &#8212; llrte 0.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Exercise 2" href="exercise_2.html" />
    <link rel="prev" title="Monte Carlo methods for radiative transfer" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="exercise-1">
<h1>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h1>
<p>The first exercise consists of two simulations of radiative transfer
through purely absorbing media. The first one is restricted to a homogeneous
medium, while in the second one the medium is heterogeneous.</p>
<p>The simulations for the first exercise can be run by building the <code class="code docutils literal notranslate"><span class="pre">exercise_1</span></code>
target using <code class="code docutils literal notranslate"><span class="pre">make</span></code>:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>$ make exercise_1
</pre></div>
</div>
<div class="section" id="part-1">
<h2>Part 1<a class="headerlink" href="#part-1" title="Permalink to this headline">¶</a></h2>
<p>The first exercise was to simulate radiation propagating through a homogeneous,
purely absorbing medium.The simulated domain extends 10 km in the x-direction
and 1 km in the y- and z-direction. The source is a perfectly colimated beam
emitting photons in the x-direction. Absorption is set to a fixed value of
<span class="math notranslate nohighlight">\(\alpha = 10^{-4}\)</span> to yield an optical depth of <span class="math notranslate nohighlight">\(\tau = 1\)</span> over the simulated
domain.</p>
<p>Two experiments were conducted here. The first one investigates the impact of
the resolution of the grid on the results and the second on the impact of the
number of simulated photons.</p>
<div class="section" id="impact-of-grid-resolution">
<h3>Impact of grid resolution<a class="headerlink" href="#impact-of-grid-resolution" title="Permalink to this headline">¶</a></h3>
<p>Shown in the figure below are the fractions of photons that reach a given
distance from the source located at 0 km. Each set of results was obtained
by simulating <span class="math notranslate nohighlight">\(10^4\)</span> photons. Colored markers show the results
for different grid resolutions. The black, dashed line shows the reference
result given by the absorption law. Since the domain is homogeneous, the
grid resolution does not have any significant impact on the results of the
simulation.</p>
<p>After all, since the domain is homogeneous it is not very surprising that
the grid resolution does not have a strong impact on the results.</p>
<div class="figure" id="id1">
<img alt="Results of exercise 1 a" src="_images/results_1_a_1.png" />
<p class="caption"><span class="caption-text">Monte carlo simulation results of a homogeneous purely absorbing medium for
varying grid resolution.</span></p>
</div>
</div>
<div class="section" id="impact-of-photon-count">
<h3>Impact of photon count<a class="headerlink" href="#impact-of-photon-count" title="Permalink to this headline">¶</a></h3>
<p>The impact of the number of simulated photons is shown in the figure below. Here
a grid resolution of 10 cells per kilometer was used and the number of simulated
photons was varied. For photon counts as low as 100 the results exhibit clearly
visible, random deviations from the reference curve. For photon counts higher
than that, however, they remain virtually indistinguishable.</p>
<div class="figure" id="id2">
<img alt="Results of exercise 1 a" src="_images/results_1_a_2.png" />
<p class="caption"><span class="caption-text">Monte carlo simulation results of a homogeneous purely absorbing medium for
varying photon counts.</span></p>
</div>
</div>
</div>
<div class="section" id="part-2">
<h2>Part 2<a class="headerlink" href="#part-2" title="Permalink to this headline">¶</a></h2>
<p>For the second part, a heterogeneous domain has been simulated.</p>
<div class="section" id="implementation">
<h3>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h3>
<p>In the current MC implementation, the absorption model that determines the
absorption at each grid point is template parameter of the atmosphere to
simulate. The implementation from the first part can therefore easily be extended
to a heterogeneous domain by defining a custom absorption model class:</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">&lt;</span><span class="n">typename</span> <span class="n">Float</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Absorption</span> <span class="n">model</span> <span class="k">for</span> <span class="n">a</span> <span class="n">heterogeneous</span> <span class="n">domain</span> <span class="n">consisting</span> <span class="n">of</span> <span class="n">two</span>
<span class="o">//</span> <span class="n">parts</span> <span class="k">with</span> <span class="n">different</span> <span class="n">absorption</span> <span class="n">coefficient</span> <span class="k">with</span> <span class="n">a</span> <span class="n">discrete</span>
<span class="o">//</span> <span class="n">boundary</span> <span class="n">along</span> <span class="n">the</span> <span class="n">x</span><span class="o">-</span><span class="n">axis</span><span class="o">.</span>
<span class="k">class</span> <span class="nc">HeterogeneousAbsorption</span> <span class="p">{</span>
<span class="n">public</span><span class="p">:</span>
    <span class="n">HeterogeneousAbsorption</span><span class="p">(</span><span class="n">Float</span> <span class="n">abs_1</span><span class="p">,</span>
                            <span class="n">Float</span> <span class="n">abs_2</span><span class="p">,</span>
                            <span class="n">Float</span> <span class="n">boundary</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">abs_1_</span><span class="p">(</span><span class="n">abs_1</span><span class="p">),</span>
        <span class="n">abs_2_</span><span class="p">(</span><span class="n">abs_2</span><span class="p">),</span>
        <span class="n">boundary_</span><span class="p">(</span><span class="n">boundary</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">Nothing</span> <span class="n">to</span> <span class="n">do</span><span class="o">.</span>
    <span class="p">}</span>
    <span class="o">//</span> <span class="n">Called</span> <span class="n">by</span> <span class="n">MC</span> <span class="n">simulation</span> <span class="n">to</span> <span class="n">get</span> <span class="nb">abs</span><span class="o">.</span> <span class="n">coeff</span><span class="o">.</span> <span class="n">at</span> <span class="n">grid</span> <span class="n">point</span><span class="o">.</span>
    <span class="n">template</span> <span class="o">&lt;</span><span class="n">typename</span> <span class="n">Grid</span><span class="p">,</span> <span class="n">typename</span> <span class="n">Position</span><span class="o">&gt;</span>
    <span class="n">Float</span> <span class="n">get_absorption_coefficient</span><span class="p">(</span><span class="n">Grid</span> <span class="o">/*</span><span class="n">grid</span><span class="o">*/</span><span class="p">,</span> <span class="n">Position</span> <span class="n">position</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">boundary_</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">abs_1_</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">abs_2_</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="n">private</span><span class="p">:</span>
    <span class="n">Float</span> <span class="n">abs_1_</span><span class="p">,</span> <span class="n">abs_2_</span><span class="p">,</span> <span class="n">boundary_</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Which is then used as absorption model in the simulated atmosphere:</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">absorption_model</span> <span class="o">=</span> <span class="n">HeterogeneousAbsorption</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.5e-4</span><span class="p">,</span> <span class="mf">1.5e-4</span><span class="p">,</span> <span class="mf">5e3</span><span class="p">);</span>
<span class="n">auto</span> <span class="n">scattering_model</span> <span class="o">=</span> <span class="n">llrte</span><span class="p">::</span><span class="n">NoScattering</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">auto</span> <span class="n">atmosphere</span> <span class="o">=</span> <span class="n">Atmosphere</span><span class="p">{</span><span class="n">grid</span><span class="p">,</span> <span class="n">absorption_model</span><span class="p">,</span> <span class="n">scattering_model</span><span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="results">
<h3>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h3>
<p>The configuration simulated here is an absorption coefficent <span class="math notranslate nohighlight">\(\alpha = 0.5 \cdot 10^{-4}\)</span>
for <span class="math notranslate nohighlight">\(x \leq 5\)</span> km and <span class="math notranslate nohighlight">\(\alpha = 1.5 \cdot 10^{-4}\)</span> for the rest of the domain.
The results are shown for varying grid resolution and photon counts in the figures shown below.</p>
<p>Since the optical depth of the simulated domain is the same, the intensity at the far end of it
are the same as in the first simulation. Nonetheless, the effect of the heterogeneity of the
domain is clearly visible through the increased decrease of the intensity in the second half
of the domain. The qualitative results regarding grid resolution and photon count are the same
as for the first part.</p>
<div class="figure" id="id3">
<img alt="Results of exercise 1 b" src="_images/results_1_b_1.png" />
<p class="caption"><span class="caption-text">Monte carlo simulation results for a heterogeneous, purely absorbing medium for
varying grid resolution.</span></p>
</div>
<div class="figure" id="id4">
<img alt="Results of exercise 1 b" src="_images/results_1_b_2.png" />
<p class="caption"><span class="caption-text">Monte carlo simulation results for a heterogeneous, purely absorbing medium for
varying photon counts.</span></p>
</div>
</div>
</div>
</div>


          </div>
          
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Simon Pfreundschuh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/exercise_1.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>