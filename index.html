
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Monte Carlo methods for radiative transfer &#8212; llrte 0.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Exercise 1" href="exercise_1.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="monte-carlo-methods-for-radiative-transfer">
<h1>Monte Carlo methods for radiative transfer<a class="headerlink" href="#monte-carlo-methods-for-radiative-transfer" title="Permalink to this headline">¶</a></h1>
<p>This project is an exploration of Monte Carlo techniques applied
to solve the radiative transfer equation (RTE).</p>
<div class="section" id="formulation">
<h2>Formulation<a class="headerlink" href="#formulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="homogeneous-and-purely-absorbing-medium">
<h3>Homogeneous and purely absorbing medium<a class="headerlink" href="#homogeneous-and-purely-absorbing-medium" title="Permalink to this headline">¶</a></h3>
<p>Starting with the simplest case, a homogeneous, purely absorbing medium,
the RTE can be solved using the following Monte Carlo approach:</p>
<ol class="arabic simple">
<li><p>Create a photon at the source. Its optical depth <span class="math notranslate nohighlight">\(\tau_\text{photon}\)</span> is zero.</p></li>
<li><p>Sample a random optical depth <span class="math notranslate nohighlight">\(\tau\)</span> from an exponential distribution <span class="math notranslate nohighlight">\(p(x) = \exp(-x)\)</span></p></li>
<li><p>Integrate the absorption coefficient <span class="math notranslate nohighlight">\(\alpha\)</span> along the photon path to obtain the photon’s optical
depth <span class="math notranslate nohighlight">\(\tau_\text{photon}\)</span>.</p></li>
<li><p>When <span class="math notranslate nohighlight">\(\tau_\text{photon} = \tau\)</span> the photon is absorbed. Continue with the next photon.</p></li>
</ol>
<p>It is easy to see that the fraction of photons reaching a given distance from their emission
source satisfies the RTE for the spectral intensity. For this, let <span class="math notranslate nohighlight">\(X\)</span> denote the path that
a photon travels prior to its absorption. Since <span class="math notranslate nohighlight">\(\tau_\text{photon}\)</span> follows an exponential
distribution, its CDF is given by <span class="math notranslate nohighlight">\(F(x) = 1 - \exp(-x)\)</span>. Noting that this is simply
the complement of the fraction of photons traveling at least a distance <span class="math notranslate nohighlight">\(\tau\)</span> it follows:</p>
<div class="math notranslate nohighlight">
\[P(\tau_\text{photon} &gt; \tau) = \exp(- \tau)\]</div>
<p>Up to boundary conditions, this is equivalent to the extinction law, which is the solution of
the RTE for a homogeneous, purely absorbing medium.</p>
</div>
<div class="section" id="scattering">
<h3>Scattering<a class="headerlink" href="#scattering" title="Permalink to this headline">¶</a></h3>
<p>The above algorithm can be easily extended to allow for multiple scattering. All that
is required for this is to</p>
<ol class="arabic simple">
<li><p>Create a photon at the source. Its optical depth <span class="math notranslate nohighlight">\(\tau_\text{photon}\)</span> is zero.</p></li>
<li><p>Sample a random optical depth :math`tau` from an exponential distribution <span class="math notranslate nohighlight">\(p(x) = \exp(-x)\)</span></p></li>
<li><p>Integrate the attenuation coefficient <span class="math notranslate nohighlight">\(\mu\)</span> along the photon path to obtain the photon’s optical
depth <span class="math notranslate nohighlight">\(\tau_\text{photon}\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\tau_\text{photon} \geq \tau\)</span>, sample another random number <span class="math notranslate nohighlight">\(r\)</span></p>
<ol class="loweralpha simple">
<li><p>If <span class="math notranslate nohighlight">\(r\)</span> is smaller or equal than the single scattering albedo, the photon is scattered. Sample
a new direction from the phase function and continue with 2.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(r\)</span> is larger than the single scattering albedo, the photon is absorbed. Continue
with the next photon.</p></li>
</ol>
</li>
</ol>
<p>Alternatively, absorption can be treated in a non-random manner. For this a
photon energy is introduced, which is set to <span class="math notranslate nohighlight">\(1.0\)</span> upon creation of the photon
and which is reduced at each step by a factor of <span class="math notranslate nohighlight">\(\exp(-\int_{\Delta s} \alpha\ ds)\)</span>.
In this case the absorption coefficient is neglected in the
calculation of <span class="math notranslate nohighlight">\(\tau_\text{photon}\)</span> and is just the path integral of the scattering
coefficient. The photon is then tracked until its energy decreases below a
suitably chosen threshold.</p>
</div>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">llrte</span></code> is implemented in C++. So far it can perform simple non-polarized RT
calculations in 3 dimensions. It makes fairly heavy use of template meta
programming with the aim of keeping the implementation general at the same time
as being computationally efficient. Another reason is of course to scare
away FORTRAN programmers.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p>The solutions to the specific solution exercises can be found below.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="exercise_1.html">Exercise 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="exercise_1.html#part-1">Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercise_1.html#part-2">Part 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="exercise_2.html">Exercise 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="exercise_2.html#part-1">Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercise_2.html#part-2">Part 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="exercise_3.html">Exercise 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="exercise_3.html#part-1">Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercise_3.html#part-2">Part 2</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
          
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Simon Pfreundschuh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>