
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Monte Carlo methods for radiative transfer &#8212; llrte 0.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="monte-carlo-methods-for-radiative-transfer">
<h1>Monte Carlo methods for radiative transfer<a class="headerlink" href="#monte-carlo-methods-for-radiative-transfer" title="Permalink to this headline">¶</a></h1>
<p>This project is an exploration of Monte Carlo techniques applied
to solve the radiative transfer equation (RTE).</p>
<div class="section" id="formulation">
<h2>Formulation<a class="headerlink" href="#formulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="homogeneous-and-purely-absorbing-medium">
<h3>Homogeneous and purely absorbing medium<a class="headerlink" href="#homogeneous-and-purely-absorbing-medium" title="Permalink to this headline">¶</a></h3>
<p>Starting with the simplest case, a homogeneous, purely absorbing medium,
the RTE can be solved using the following Monte Carlo approach:</p>
<ol class="arabic simple">
<li>Start with a photon entering a discretized medium</li>
<li>Determine a sufficiently small step sixe <span class="math notranslate nohighlight">\(\Delta x\)</span></li>
<li>Sample a random number <span class="math notranslate nohighlight">\(r\)</span> from a uniform distribution over the inverval <span class="math notranslate nohighlight">\([0, 1]\)</span></li>
<li><dl class="first docutils">
<dt>If <span class="math notranslate nohighlight">\(r &gt; \exp(-\alpha \cdot \Delta x)\)</span> the photon is absorbed and the iteration stops. Otherwise</dt>
<dd>update the position of the photon continue with 1.</dd>
</dl>
</li>
</ol>
<p>The probability density function (PDF) of path lengths obtained with the procedure outlined above
will satisfy the differential form of the RTE. To see why this is the case, note that the
distribution of path lengths generated by the algorithm described above is <em>memoryless</em>. This
means that, given a photon has traveled a path of length <span class="math notranslate nohighlight">\(X &gt; x\)</span>, the probability of reaching
<span class="math notranslate nohighlight">\(X &gt; x + \Delta x\)</span> is independent of <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="math notranslate nohighlight">
\[P(X &gt; x + \Delta x | X &gt; x) = \exp(- \alpha \cdot \Delta x)\]</div>
<p>which is the same as</p>
<div class="math notranslate nohighlight">
\[\frac{P(X &gt; x + \Delta x)}{P(X &gt; x)} = \exp(-\alpha \cdot \Delta x).\]</div>
<p>Now, taking the logarithm on the left side, diving by <span class="math notranslate nohighlight">\(\Delta x\)</span> and making
<span class="math notranslate nohighlight">\(\Delta x\)</span> sufficiently small, the following differential equation is obtained
for the PDF <span class="math notranslate nohighlight">\(\frac{dP(X &gt; x)}{dx}\)</span> of <span class="math notranslate nohighlight">\(X\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\log(P(X &gt; x + \Delta) - \log(P(X &gt; x))}{\Delta x} = - \alpha \\
\frac{d \log(P(X &gt; x))}{dx} = -\alpha  \\
\frac{dP(X &gt; x)}{dx} = -\alpha \cdot P(X = x)\end{split}\]</div>
<p>The function <span class="math notranslate nohighlight">\(P(X &gt; x)\)</span> thus satisfies the differential form
of the radiative transfer equation for a purely absorbing medium.
<span class="math notranslate nohighlight">\(P(X &gt; x)\)</span> can be approximated by recording the frequencies
with which photons visit gird cells in the discretized domain.</p>
</div>
</div>
<div class="section" id="preliminary-results">
<h2>Preliminary results<a class="headerlink" href="#preliminary-results" title="Permalink to this headline">¶</a></h2>
<p>So far <code class="code docutils literal notranslate"><span class="pre">llrte</span></code> can do non-polarized RT on three-dimensional, regular
cartesian grids. Some preliminary results are presented below.</p>
<div class="section" id="collimated-beam-in-1d">
<h3>Collimated beam in 1D<a class="headerlink" href="#collimated-beam-in-1d" title="Permalink to this headline">¶</a></h3>
<p>To test the implementation a perfectly colimated beam propagating through
a one-dimensional, homogeneous medium is simulated. The homogeneous medium
of a length of <span class="math notranslate nohighlight">\(10\)</span> km has been discretized into 100 equally
sized bins. For each bin it was recorded how often a photons passes through
it. The resulting counts normalized by the total number of simulated photons
(<span class="math notranslate nohighlight">\(10^7\)</span>) are shown in the figure below. Red markers show the simulated
results, the dashed line shows the analytical solution.</p>
<a class="reference internal image-reference" href="_images/mc_1.png"><img alt="_images/mc_1.png" src="_images/mc_1.png" style="width: 100%;" /></a>
</div>
<div class="section" id="isotropic-point-source">
<h3>Isotropic point source<a class="headerlink" href="#isotropic-point-source" title="Permalink to this headline">¶</a></h3>
<p>As simple test case an isotropically emitting point source in a homogeneous medium
is considered. The point source is placed in the center of a cube with dimensions
<span class="math notranslate nohighlight">\(10\ \text{km} \times 10\ \text{km} \times 10\ \text{km}\)</span>, which is discretized
into 101 bins along each dimension.</p>
<p>Intersections through the normalized intensity along the coordinate planes are
displayed in the figure below. The observed frequencies have been scaled by the
squared distance from the source to account for beam divergence effects. The regular
distances between the log-scaled color contours show that the spectral intensity
decreases exponentially, which is the expected behavior.</p>
<p>To verify this more thoroughly</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">llrte</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Simon Pfreundschuh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>